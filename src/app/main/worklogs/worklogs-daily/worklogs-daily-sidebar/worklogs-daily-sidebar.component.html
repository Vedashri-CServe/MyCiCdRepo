<div class="slideout-content">
  <div class="modalsd modal-slide-in sdfade new-user-modal" id="modals-slide-in">
    <div class="modal-dialog" style="width: 50%;">
      <div class="modal-content py-0">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" *ngIf="isEditShowDailyPlan"
          (click)="toggleSidebar('worklogs-daily-sidebar')">
          ×
        </button>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" *ngIf="!isEditShowDailyPlan"
          (click)="toggleSidebar('worklogs-timesheet-sidebar')">
          ×
        </button>
        <div class="modal-header mb-1">
          <h5 class="modal-title" id="exampleModalLabel">Daily Work Plan</h5>
        </div>
        <div class="modal-body flex-grow-1 h-100">
          <section id="basic-tabs-components" class="h-100">
            <div class="match-height card-body sidebar-content">
              <ul ngbNav #nav="ngbNav" [(activeId)]="active" class="nav-tabs">
                <li [ngbNavItem]="1">
                  <a ngbNavLink *ngIf="isEdit" (click)="getData('Work')">Work Plan</a>
                  <ng-template ngbNavContent>
                    <form class="add-worklogs-daily-sidebar" (ngSubmit)="(newUserForm.form.valid)"
                      #newUserForm="ngForm">
                      <div class="customfield">
                        <div class="customf">
                          <div class="form-group">
                            <div class="d-flex">
                              <div class="custom-control custom-radio w-100">
                                <input type="radio" id="customRadio3" name="checkValueShow" [(ngModel)]="checkValueShow"
                                  value="Auto" class="custom-control-input" [disabled]="isEdit " checked />
                                <label class="custom-control-label" for="customRadio3">Auto</label>
                              </div>
                              <div class="custom-control custom-radio w-100">
                                <input type="radio" id="customRadio4" name="checkValueShow" [(ngModel)]="checkValueShow"
                                  value="Manual" class="custom-control-input" [disabled]="isEdit" />
                                <label class="custom-control-label" for="customRadio4">Manual</label>
                              </div>
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="form-label">Client Name</label>
                            <ng-select [items]="cpaList" bindLabel="name" [loading]="selectBasicLoading"
                              (change)="onChange($event,'change')" name="cpaName" [(ngModel)]="cpaName"
                              [class.error]="newUserForm.submitted && !cpaName" #FCpaName="ngModel"
                              [disabled]="(isEdit && stoplogdisableditem) || !isEditShowDailyPlan" required>
                            </ng-select>
                            <span *ngIf="newUserForm.submitted && !cpaName" class="invalid-form">
                              <small class="form-text text-danger" *ngIf="FCpaName.errors?.required">This field is
                                required!</small>
                            </span>
                          </div>
                          <div class="form-group">
                            <label class="form-label">Project Name</label>
                            <ng-select [items]="clientList" (change)="onChangeClient($event)" bindLabel="name"
                              name="clientName" [(ngModel)]="clientName"
                              [disabled]="(isEdit && stoplogdisableditem) || !isEditShowDailyPlan"
                              [class.error]="newUserForm.submitted && !clientName" #FClientName="ngModel" required>
                            </ng-select>
                            <span *ngIf="newUserForm.submitted &&  !clientName" class="invalid-form">
                              <small class="form-text text-danger" *ngIf="FClientName.errors.required">This field is
                                required!</small>
                            </span>
                          </div>
                          <div class="form-group" *ngIf="userData.WorkCategory == 33">
                            <div class="d-flex">
                              <div class="custom-control custom-radio w-100">
                                <input type="radio" id="customRadio1" name="checkInputShow" [(ngModel)]="checkInputShow"
                                  value="Task" class="custom-control-input" (change)="onChangeInput()"
                                  [disabled]="isEdit && stoplogdisableditem" checked />
                                <label class="custom-control-label" for="customRadio1">Task</label>
                              </div>
                              <div class="custom-control custom-radio w-100">
                                <input type="radio" id="customRadio2" name="checkInputShow" (change)="onChangeInput()"
                                  [(ngModel)]="checkInputShow" value="Process" class="custom-control-input"
                                  [disabled]="isEdit && stoplogdisableditem" />
                                <label class="custom-control-label" for="customRadio2">Process</label>
                              </div>
                            </div>
                          </div>
                          <div class="form-group" *ngIf="checkInputShow == 'Task' && userData.WorkCategory != 32">
                            <label class="form-label">Task Name</label>
                            <ng-select [items]="taskList" bindLabel="name" name="taskName" [(ngModel)]="taskName"
                              (change)="onTaskChange(taskName)" required
                              [disabled]="(isEdit && stoplogdisableditem) || !isEditShowDailyPlan"
                              [class.error]="newUserForm.submitted && !taskName" #FTaskName="ngModel">
                            </ng-select>
                            <span *ngIf="newUserForm.submitted && checkInputShow == 'Task' && !taskName"
                              class="invalid-form">
                              <small class="form-text text-danger"
                                *ngIf="FTaskName.errors?.required && checkInputShow == 'Task'">This field is
                                required!</small>
                            </span>
                            <ng-container *ngIf="EstimatedDuration != 0"><b> Estimated Duration :</b>
                              {{EstimatedDuration}}</ng-container>
                          </div>
                          <div class="form-group"
                            *ngIf="checkInputShow == 'Process' && (userData.WorkCategory == 32 || userData.WorkCategory == 33)">
                            <label class="form-label">Process Name</label>
                            <ng-select [items]="processList" bindLabel="name" name="process" [(ngModel)]="process"
                              (change)="onProcessChange(process)" [class.error]="newUserForm.submitted && !process"
                              #FProcessName="ngModel"
                              [disabled]="(isEdit && stoplogdisableditem) || !isEditShowDailyPlan" required>
                            </ng-select>
                            <span *ngIf="newUserForm.submitted && checkInputShow == 'Process' && !process"
                              class="invalid-form">
                              <small class="form-text text-danger"
                                *ngIf="FProcessName.errors?.required && checkInputShow != 'Task'">This field is
                                required!</small>
                            </span>
                          </div>
                          <div class="form-group"
                            *ngIf="checkInputShow == 'Process' && (userData.WorkCategory == 32 || userData.WorkCategory == 33)">
                            <label class="form-label">Sub Process</label>
                            <ng-select [items]="subProcessList" (change)="onSubProcessChange(subProcess)"
                              bindLabel="name" name="subProcess" [(ngModel)]="subProcess"
                              [class.error]="newUserForm.submitted && !subProcess" #FSubProcessName="ngModel"
                              [disabled]="(isEdit && stoplogdisableditem) || !isEditShowDailyPlan" required>
                            </ng-select>
                            <span *ngIf="newUserForm.submitted && checkInputShow == 'Process' && !subProcess"
                              class="invalid-form">
                              <small class="form-text text-danger"
                                *ngIf="FSubProcessName.errors?.required && checkInputShow != 'Task'">This field is
                                required!</small>
                            </span>
                            <ng-container *ngIf="EstimatedDuration != 0"><b> Estimated Duration :</b>
                              {{EstimatedDuration}}</ng-container>
                          </div>
                          <div class="form-group">
                            <label>Description</label>
                            <input class="form-control" type="text"
                              oninput="this.value = this.value.replace(/[^A-Za-z0-9-,.;'&/.() ]|^ /g,'')"
                              placeholder="Please add description" name="description" [(ngModel)]="description"
                              #FDescriptionRef="ngModel"
                              [class.error]="newUserForm.submitted && FDescriptionRef.invalid" required
                              [disabled]="(isEdit && stoplogdisableditem) || !isEditShowDailyPlan" />
                            <span *ngIf="newUserForm.submitted && FDescriptionRef.invalid" class="invalid-form">
                              <small class="form-text text-danger" *ngIf="FDescriptionRef.errors.required">This field is
                                required!</small>
                            </span>
                          </div>
                          <div class="form-group">
                            <label>Quantity</label>
                            <input class="form-control" type="text"
                              oninput="this.value = this.value.replace(/[^A-Za-z0-9-,.;'&/.() ]|^ /g,'')"
                              pattern="[1-9][0-9]*" maxlength="4" placeholder="Please enter number of quantity"
                              name="quantity" [(ngModel)]="quantity" (input)="InputChange($event.target.value)"
                              #FQuantityRef="ngModel" [class.error]="newUserForm.submitted && FQuantityRef.invalid"
                              required [disabled]="(isEdit && stoplogdisableditem) || !isEditShowDailyPlan" />
                            <span *ngIf="newUserForm.submitted && FQuantityRef.invalid" class="invalid-form">
                              <small class="form-text text-danger" *ngIf="FQuantityRef.errors.required">This field is
                                required!</small>
                              <small class="form-text text-danger" *ngIf="FQuantityRef.errors?.pattern">Please enter
                                valid quantity</small>
                            </span>
                          </div>
                        </div>
                        <div><b> Standard Hours: </b> {{TotalEstimatedTime}}</div>
                        <div class="form-group" *ngIf="checkValueShow == 'Manual'">
                          <label>Total Hours</label>
                          <input class="form-control" type="text" placeholder="00:00" [patterns]="patterns" mask="01:23"
                            name="manualTaskTime" [(ngModel)]="manualTaskTime" [disabled]="!isEditShowDailyPlan"
                            [class.error]="newUserForm.submitted && FEstimatedHoursRef.invalid"
                            #FEstimatedHoursRef="ngModel" required />
                          <span *ngIf="(newUserForm.submitted && FEstimatedHoursRef.invalid) || (manualTaskTime == 0)"
                            class="invalid-form">
                            <small class="form-text text-danger"
                              *ngIf="newUserForm.submitted && FEstimatedHoursRef.errors?.required">This field is
                              required!</small>
                            <small class="form-text text-danger"
                              *ngIf="manualTaskTime == 0 && !FEstimatedHoursRef.errors?.required">Please enter less or
                              equal to 07:59 hours</small>
                          </span>
                        </div>
                        <div class="form-group" *ngIf="!isEditShowDailyPlan">
                          <label>Edit Total Hours</label>
                          <input class="form-control" type="text" placeholder="00:00" name="editTotalTime"
                            [patterns]="patterns" mask="01:23" [(ngModel)]="editTotalTime"
                            [class.error]="newUserForm.submitted && FeditTotalTimeForm.invalid && !isEditShowDailyPlan"
                            #FeditTotalTimeForm="ngModel" required />
                          <span
                            *ngIf="!isEditShowDailyPlan && ((newUserForm.submitted && FeditTotalTimeForm.invalid) || (editTotalTime == 0))"
                            class="invalid-form">
                            <small class="form-text text-danger"
                              *ngIf="newUserForm.submitted && FeditTotalTimeForm.errors?.required">This field is
                              required!</small>
                            <small class="form-text text-danger"
                              *ngIf="manualTaskTime == 0 && !FeditTotalTimeForm.errors?.required">Please enter less or
                              equal to 07:59 hours</small>
                          </span>
                        </div>
                        <div class="form-group">
                          <button type="submit" rippleeffect="" (click)="submit(newUserForm)"
                            *ngIf="((editDataDailyWorkplan?.Status?.Value != '17') || (!isEdit && !stoplogdisableditem) || (checkValueShow == 'Manual' || (!isEdit && checkValueShow != 'Manual')) && !isShowEdit)  && isEditShowDailyPlan"
                            class="btn btn-primary mr-1 waves-effect waves-float waves-light round mt-1">{{!isEdit ?
                            'Create Work Plan':'Update Work Plan'}}</button>
                          <button type="submit" rippleeffect="" (click)="submitActualHover(newUserForm)"
                            *ngIf="!isEditShowDailyPlan"
                            class="btn btn-primary mr-1 waves-effect waves-float waves-light round mt-1">{{!isEdit ?
                            'Create Work Plan':'Update Work Plan'}}</button>
                        </div>
                      </div>
                    </form>
                  </ng-template>
                </li>
                <li [ngbNavItem]="2" *ngIf="isEdit">
                  <a ngbNavLink (click)="getData('Checklist')">Checklist</a>
                  <ng-template ngbNavContent>
                    <div class="customfield">
                      <div class="customf">
                        <h4>{{showTaskName}}</h4>
                        <table class="table accounting-fix-table">
                          <tbody>
                            <tr *ngFor="let data of checkListData">
                              <td> <input class="form-check-input" type="checkbox" id="inlineCheckbox1"
                                  value="{{data.IsChecked}}" [checked]="data.IsChecked == true"
                                  (change)="changed($event,data)" *ngIf="!(stoplogdisableditem)" /> &nbsp;
                                {{data.Description}}
                              </td>
                              <td class="d-flex justify-content-end"> <button
                                  class="btn btn-icon btn-tms-secondary mr-1 btn-tms-theme" rippleEffect
                                  (click)="editData('edit',data)" *ngIf="!(stoplogdisableditem)">
                                  <span [data-feather]="'edit'"></span>
                                </button>
                                <button class="btn btn-icon btn-tms-secondary btn-tms-delete"
                                  [swal]="SweetAlertConfirmText" *ngIf="!(stoplogdisableditem)" rippleEffect>
                                  <span [data-feather]="'trash-2'"></span>
                                </button>
                              </td>
                              <swal #SweetAlertConfirmText (open)="ConfirmTextOpen(data)"></swal>
                            </tr>
                            <tr *ngIf="checkListData && checkListData.length == 0"> No records found!</tr>
                          </tbody>
                        </table>
                      </div>
                      <form (ngSubmit)="(newChecklistForm.form.valid)" #newChecklistForm="ngForm"
                        *ngIf="!(stoplogdisableditem)">
                        <div class="row border-top pt-1">
                          <div class="col-md-9">
                            <label class="largeunput">Add Checklist Points</label>
                            <input class="form-control checklist-cstm-design" type="text"
                              oninput="this.value = this.value.replace(/[^A-Za-z0-9-,.;'&/.() ]|^ /g,'')"
                              id="checkListDescription" name="checkListDescription" #FCheckLsitRef="ngModel"
                              [(ngModel)]="checkListDescription" placeholder="Please add checklist point"
                              [disabled]="stoplogdisableditem" required />
                          </div>
                          <div class="col-md-3">
                            <button type="submit" rippleeffect=""
                              class="btn btn-primary mr-1 waves-effect waves-float waves-light mt-2 round"
                              (click)="addCheckList()" [disabled]="(!checkListDescription)">Add</button>
                          </div>
                        </div>
                      </form>
                    </div>
                  </ng-template>
                </li>
                <li [ngbNavItem]="3" *ngIf="isEdit">
                  <a ngbNavLink (click)="getData('Comments')">Comments</a>
                  <ng-template ngbNavContent>
                    <div class="customfield">
                      <div class="customf comment_scrollable">
                        <div class="scrollable-container media-list ps ps--active-y">
                          <div *ngFor="let commentData of commentListData">
                            <div class="media d-flex align-items-start p-1" *ngIf="commentData.IsComment == true">
                              <div class="media-left" *ngIf="commentData.IsComment == true">
                                <div class="avatar">
                                  <img alt="avatar" width="32" height="32" src="assets/images/portrait/small/user.jpg">
                                </div>
                              </div>
                              <div class="media-body" *ngIf="commentData.IsComment == true">
                                <p class="media-heading" style="margin-bottom: 0px;"><span
                                    class="font-weight-bolder">{{commentData.CommentBy}}</span></p>
                                <p style="margin-bottom: 0px; font-size: 12px;">{{commentData.CreatedOn}}</p>
                                <p class="notification-text" style="color: black;">{{commentData.Comment}}</p>
                              </div>
                            </div>
                          </div>
                          <div *ngIf="commentListData && commentListData.length == 0">No records found!</div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-9">
                          <form (ngSubmit)="(newCommentForm.form.valid)" #newCommentForm="ngForm">
                            <input class="form-control" type="text" name="commentDescription" id="commentDescription"
                              maxlength="500"
                              oninput="this.value = this.value.replace(/[^A-Za-z0-9-,.;'&/.() ]|^ /g,'')"
                              [(ngModel)]="commentDescription" placeholder="Please add comment" />
                            <span>
                              <small class="form-text text-danger" *ngIf="commentDescription && commentDescription != '' && commentDescription.length == 500">You can't
                                use more than 500 characters</small>
                            </span>
                          </form>
                        </div>
                        <div class="col-md-3">
                          <button type="submit" rippleeffect=""
                            class="btn btn-primary mr-1 waves-effect waves-float waves-light round"
                            (click)="addComment()" [disabled]="!commentDescription">Add</button>
                        </div>
                      </div>
                    </div>
                  </ng-template>
                </li>
                <li [ngbNavItem]="4" *ngIf="isEdit">
                  <a ngbNavLink (click)="getData('Recurring')">Recurring</a>
                  <ng-template ngbNavContent>
                    <div class="customfield">
                      <div class="customf">
                        <div class="row">
                          <div class="form-group col-md-6">
                            <label for="startDate">Start Date</label>
                            <div class="input-group">
                              <input class="form-control" id="startDate" placeholder="yyyy-mm-dd" name="startDate"
                                [(ngModel)]="startDate" ngbDatepicker #startDP="ngbDatepicker" readonly />
                              <div class="input-group-append">
                                <button class="btn btn-outline-secondary feather icon-calendar"
                                  (click)="startDP.toggle()" type="button" [disabled]="stoplogdisableditem"
                                  rippleEffect></button>
                              </div>
                            </div>
                          </div>
                          <div class="form-group col-md-6">
                            <label for="endDate">End Date</label>
                            <div class="input-group">
                              <input class="form-control" id="endDate" placeholder="yyyy-mm-dd" name="endDate"
                                [minDate]="startDate" [(ngModel)]="endDate" ngbDatepicker #endDP="ngbDatepicker"
                                readonly />
                              <div class="input-group-append">
                                <button class="btn btn-outline-secondary feather icon-calendar" (click)="endDP.toggle()"
                                  type="button" [disabled]="stoplogdisableditem" rippleEffect></button>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="form-group col-md-12 recuring-style">
                            <label class="form-label mr-2">Repeat Every</label>
                            <input class="form-control mr-2" type="text" id="OccuresDay" *ngIf="checkDaily == 'day'"
                              [(ngModel)]="OccuresDay" name="OccuresDay" placeholder="1" maxlength="3"
                              [disabled]="stoplogdisableditem">
                            <select class="form-control" [(ngModel)]="OccuresOption"
                              (change)="onChangeEvent($event.target.value)" [disabled]="stoplogdisableditem">
                              <option value="day">Day</option>
                              <option value="week">Week</option>
                              <option value="month">Month</option>
                            </select>
                          </div>
                        </div>
                        <div *ngIf="checkDaily == 'day'"> Occures every {{OccuresDay}} day.</div>
                        <div *ngIf="checkDaily == 'week'">
                          <core-card-snippet [snippetCode]="_snippetCodeFlat">
                            <div class="card-body px-0">
                              <div class="row">
                                <div class="col-12">
                                  <div class="demo-inline-spacing">
                                    <div class="form-group" *ngFor="let d of allcheck">
                                      <input type="checkbox" [id]="d.id" [checked]="d.checked"
                                        (change)="d.checked = !d.checked" (change)="add_week()"
                                        [disabled]="stoplogdisableditem">
                                      <label class="btn  button_select rounded-circle " [for]="d.id">{{d.sname}}</label>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </core-card-snippet>
                          <ng-container> Occures on every <span *ngFor="let d of selected;let last = last"> {{ d.name }}
                              <ng-container *ngIf="!last">,</ng-container> </span>
                          </ng-container>
                        </div>
                        <div *ngIf="checkDaily == 'month'" class="recuring-style">
                          <div class="row">
                            <div class="col-md-12">
                              <div class="mb-1">
                                <label class="form-check-label mr-2">On Day :</label>
                                <select class="form-control mr-2" [(ngModel)]="monthDays" name="monthDays">
                                  <option value="{{day}}" *ngFor="let day of WeekDaysArray;let i = index">{{day}}
                                  </option>
                                </select>
                              </div>
                            </div>
                            <p class="mx-2"> Occures every month on day {{monthDays}}</p>
                          </div>
                        </div>
                      </div>
                      <div>
                        <button type="submit" rippleeffect="" (click)="addRecurring()" *ngIf="!(stoplogdisableditem)"
                          [disabled]="(!startDate && !endDate) || stoplogdisableditem"
                          class="btn btn-primary mr-1 waves-effect waves-float waves-light round">Save</button>
                      </div>
                    </div>
                  </ng-template>
                </li>
                <li [ngbNavItem]="5" *ngIf="isEdit">
                  <a ngbNavLink ngbNavLink (click)="getData('Reason')">Reason</a>
                  <ng-template ngbNavContent>
                    <div class="customfield">
                      <div class="customf comment_scrollable">
                        <div class="scrollable-container media-list ps ps--active-y">
                          <div *ngFor="let commentData of commentListData">
                            <div class="media d-flex align-items-start p-1" *ngIf="commentData.IsComment == false">
                              <div class="media-left">
                                <div class="avatar">
                                  <img alt="avatar" width="32" height="32" src="assets/images/portrait/small/user.jpg">
                                </div>
                              </div>
                              <div class="media-body" *ngIf="commentData">
                                <p class="media-heading" style="margin-bottom: 0px;"><span
                                    class="font-weight-bolder">{{commentData.CommentBy}}</span></p>
                                <p style="margin-bottom: 0px; font-size: 12px;">{{commentData.CreatedOn}}</p>
                                <p class="notification-text" style="color: black;">{{commentData.Comment}}</p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </ng-template>
                </li>
              </ul>
              <div [ngbNavOutlet]="nav" class="mt-2"></div>
            </div>
          </section>
        </div>
      </div>
    </div>
  </div>
</div>
<block-ui> </block-ui>